{% extends "admin/base_site.html" %}

<!-- LOADING -->
{% load adminmedia admin_list i18n grp_tags grp_csrf %}

<!-- JAVASCRIPTS -->
{% block javascripts %}
    {{ block.super }}
    {% if cl.formset %}{{ media }}{% endif %}
    <script type="text/javascript">
    $.grappelli.conf.set('isPopup', {% if is_popup or 'pop' in request.GET %}true{% else %}false{% endif %});
    </script>
{% endblock %}

<!-- COLTYPE/BODYCLASS-- >
{% block bodyclass %}change-list{% endblock %}
{% block content-class %}content-flexible{% endblock %}

<!-- BREADCRUMBS -- >
{% block breadcrumbs %}
{% if not is_popup %}
    <div id="breadcrumbs">
        <a href="{% if request.session.grappelli.home %}{{ request.session.grappelli.home }}{% else %}{% get_admin_url %}{% endif %}">{% trans "Home" %}</a> &rsaquo;
        <a href="../">{{ app_label|capfirst }}</a> &rsaquo;
        {{ cl.opts.verbose_name_plural|capfirst }}
    </div>
{% endif %}
{% endblock %}

{% block content_title %}
    <h1>{{ cl.opts.verbose_name_plural|capfirst }}</h1>
{% endblock %}

<!-- Object-Tools -->
{% block object-tools %}
    {% if has_add_permission %}
        <ul class="tools" style="right: x240px !important">
            <li>
                <a href="add/{% if is_popup %}?_popup=1{% endif %}" class="focus">
                    {% blocktrans with cl.opts.verbose_name as name %}Add {{ name }}{% endblocktrans %}
                </a>
            </li>
        </ul>
    {% endif %}
{% endblock %}

<!-- CONTENT -->
{% block content %}
    <div id="changelist" class="container-flexible">
        
        <div class="column span-flexible">
            <!-- Popup Hidden Field -->
            {% if is_popup %}<input type="hidden" name="_popup" value="1" />{% endif %}
            <!-- Errors -->
            {% if cl.formset.errors %}
                <p class="errornote">
                    {% blocktrans count cl.formset.errors|length as counter %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktrans %}
                </p>
                <ul class="errorlist">{% for error in cl.formset.non_field_errors %}<li>{{ error }}</li>{% endfor %}</ul>
            {% endif %}
            <!-- Management Form -->
            {% if cl.formset %}
                {{ cl.formset.management_form }}
            {% endif %}
            <form action="" method="post"{% if cl.formset.is_multipart %} enctype="multipart/form-data"{% endif %}>{% grp_csrf_token %}
                <div class="group changelist-content">
                    {% block result_list %}
                        {% if action_form and actions_on_top and cl.full_result_count and cl.result_count %}{% admin_actions %}{% endif %}
                        {% result_list cl %}
                        {% if action_form and actions_on_bottom and cl.full_result_count and cl.result_count %}{% admin_actions %}{% endif %}
                    {% endblock %}
                </div>
                <div class="module footer">
                    {% block pagination %}{% pagination cl %}{% endblock %}
                    {% if cl.formset and cl.result_count %}
                        <ul class="submit-row">
                            <li><input type="submit" class="default" value="Save"/></li>
                        </ul>
                    {% endif %}
                </div>
            </form>
        </div>
        <div class="column span-6 last sidebar">
            {% block filters %}
                {% if cl.has_filters or cl.search_fields or cl.date_hierarchy %}
                    <!-- Results -->
                    {% ifnotequal cl.result_count cl.full_result_count %}
                        <div class="module filter-results">
                            <h2>{% trans 'Results' %}</h2>
                            <div class="form-row">
                                <p>{% blocktrans with cl.result_count as counter %}{{ counter }} found{% endblocktrans %}</p>
                                <a href="?{% if cl.is_popup %}pop=1{% endif %}">{% blocktrans with cl.full_result_count as full_result_count %}{{ full_result_count }} total{% endblocktrans %}</a>
                            </div>
                        </div>
                    {% endifnotequal %}
                    <!-- Search -->
                    {% block search %}{% search_form cl %}{% endblock %}
                    <!-- Date Hierarchy -->
                    {% block date_hierarchy %}{% date_hierarchy cl %}{% endblock %}
                    <!-- Filter -->
                    {% if cl.has_filters %}
                        <!-- Filter -->
                        <div class="module filter">
                            <h2>{% trans 'Filter' %}</h2>
                            {% for spec in cl.filter_specs %}{% admin_list_filter cl spec %}{% endfor %}
                        </div>
                    {% endif %}
                {% endif %}
            {% endblock %}
        </div>
    </div>
{% endblock %}
